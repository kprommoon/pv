<!DOCTYPE html>

<html>
<head>
  <title>SME Kit</title>
  <!-- test -->
  <!-- ** CSS ** -->
  <!-- base library -->
  <link rel="stylesheet" type="text/css" href="extjs/ext-all.css" />

  <!-- overrides to base library -->
  <link rel="stylesheet" type="text/css" href="extjs/resources/css/xtheme-gray.css" />
  <link rel="stylesheet" type="text/css" href="extjs/ux/css/Portal.css" />

  <!-- page specific -->
  <link rel="stylesheet" type="text/css" href="css/style.css" />

  <style type="text/css">
    .message {
        margin: 7px 5px;
        background-color: #eee;
        border: 1px solid #999;
    }

    .message-top {
        background-color: #777;
        color: #fff;
        font-size: 14px;
        padding: 2px 5px;
    }

    .message-body {
        font-size: 12px;
        padding: 2px 5px;
    }

    .message-bottom {
        border-top: 1px solid #fff;
        margin-top: 5px;
        padding: 2px 5px;
        font-size: 10px;
        text-align: right;
    }


  </style>

  <!-- ** Javascript ** -->

  <!-- base library -->
  <script type="text/javascript" src="extjs/core/ext-base.js"></script>
  <script type="text/javascript" src="extjs/core/ext-all-debug.js"></script>

  <!-- extensions -->
  <script type="text/javascript" src="extjs/ux/Portal.js"></script>
  <script type="text/javascript" src="extjs/ux/PortalColumn.js"></script>
  <script type="text/javascript" src="extjs/ux/Portlet.js"></script>
  <script type="text/javascript" src="extjs/ux/SearchField.js"></script>
  <script type="text/javascript" src="extjs/ux/TabCloseMenu.js"></script>

  <!-- page specific -->
  <script type="text/javascript">
Ext.onReady(function(){
    /*!
     * Project Menu
     */
    var projectMenu = new Ext.Toolbar({
        items: [{
            text: 'New',
            menu: new Ext.menu.Menu({
                items: [{
                    text: 'Quotation'
                },{
                    text: 'Invoice'
                },{
                    text: 'Job'
                },{
                    text: 'PO'
                },{
                    text: 'Files'
                },{
                    text: 'Project'
                },{
                    text: 'Payment'
                },{
                    text: 'Expense'
                }]
            })
        },{
            text: 'Delete'
        }]
    });

    /*!
     * Project Bag
     */
    var treePan = new Ext.tree.TreePanel({
        animate: true,
        loader: new Ext.tree.TreeLoader(),
        rootVisible: false,
        lines: false,
        root: new Ext.tree.AsyncTreeNode({
            id: 'isroot',
            expanded: true,
            children: [{
                text: 'Project Summary',
                leaf: true
            },{
                text: 'Profit & Loss',
                leaf: true
            },{
                text: 'Quotation',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Invoice',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Job',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'PO',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Files',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Project',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Payment',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            },{
                text: 'Expense',
                leaf: false,
                children: [{
                    text: '01/01/2010',
                    leaf: true
                },{
                    text: '10/10/2010',
                    leaf: true
                }]
            }]
        })
    });

    /*!
     * Message Board
     */
    var mesBoard = [
        {
            region: 'center',
            layout: 'fit',
            items: [{
                autoScroll: true,
                html: '<div id="mboard">' + message('This quotation need to ' +
                    'prove by p\'Suda befor send to customer.') + '</div>'
            }]
        },{
            region: 'south',
            height: 150,
            split: false,
            title: 'Post a message',
            items: [{
                xtype: 'htmleditor',
                id: 'posttext',
	            enableColors: false,
                enableAlignments: false,
	            enableFont: false,
	            enableLinks: false,
	            enableFontSize: false,
    	        enableSourceEdit: false,
            }],
            bbar: {
                items:[{
                    text: 'Submit',
                    iconCls: 'save',
    	            handler: function(){
                        var dh = Ext.DomHelper;
						postText = Ext.getCmp('posttext').getValue();
		                mboard = Ext.getDom('mboard').innerHTML;
		                mboard += message(postText);
		                Ext.getDom('mboard').innerHTML = mboard;
		                Ext.getCmp('posttext').setValue("");
		            }
                }]
            }
        }
    ];

    /*!
     * Message Board functions
     */
    function dateTimeToText(dt) {
		    var month = dt.getMonth() + 1
		    var day = dt.getDate()
		    var year = dt.getFullYear()
		    var min = dt.getMinutes()
		    var hour = dt.getHours()
		    return ("" + hour + ":" + min + " " + month + "/" + day + "/" + year)
    }

    function currentTime() {
		var currentTime = new Date()
		return dateTimeToText(currentTime)
    }

    function message(text) {
        var result = '';
        result += '<div class="message">';
        result += '<div class="message-top">';
        result += 'User';
        result += '</div>';
        result += '<div class="message-body">';
        result += text;
        result += '</div>';
        result += '<div class="message-bottom">';
        result += currentTime();
        result += '</div>';
        result += '</div>';
        return result;
    }

    /*!
     * Application Tab
     */
    var appTab = new Ext.TabPanel({
        activeTab: 1,
    	plain:true,
        id: 'application-tab',
        defaults: {
            closable: true
        },
        items: [{
            id: 'home',
            closable: false,
            title: 'Home',
            iconCls: 'home',
            tbar: ['Company Name','-',
            new Ext.app.SearchField({
                width:240,
                store: this.searchStore,
                paramName: 'q',
            }),'->','FirstName LastName','-',
            {
                text: 'Preference',
                iconCls: 'preference'
            },'-',{
                text: 'Logout',
                iconCls: 'logout'
            }],
        },{
            title: 'Demo Project',
            layout: 'border',
            items: [{
                region: 'west',
                title: 'Project Bag',
                width: 200,
                split: true,
                collapsible: true,
                layout: 'fit',
                items: [treePan],
                bbar: projectMenu
            },{
                region: 'center'
            },{
                region: 'east',
                title: 'Message Board',
                layout: 'border',
                items: mesBoard,
                width: 300,
                split: true,
                collapsible: true
            }]
        }],
        plugins: new Ext.ux.TabCloseMenu()
    });

    /*!
     * Viewport
     */
    var viewport = new Ext.Viewport({
        layout: 'fit',
        defaults: {
            autoScroll: true,
            style: 'overflow-x: hidden'
        },
        items: [appTab]
    });
})
  </script>
</head>

<body>
</body>

</html>
